/*! For license information please see forum.js.LICENSE.txt */
(()=>{var t={362:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.stringify=e.parse=void 0,o(r(761),e);var s=r(761);Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return a(s).default}});var i=r(519);Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return a(i).default}})},761:function(t,e){"use strict";var r=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.isTraversal=void 0;var n=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,o=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,a=new Map([["~","element"],["^","start"],["$","end"],["*","any"],["!","not"],["|","hyphen"]]),s={">":"child","<":"parent","~":"sibling","+":"adjacent"},i={"#":["id","equals"],".":["class","element"]},l=new Set(["has","not","matches","is","where","host","host-context"]),u=new Set(r(["descendant"],Object.keys(s).map((function(t){return s[t]})),!0)),c=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function f(t){return u.has(t.type)}e.isTraversal=f;var p=new Set(["contains","icontains"]),m=new Set(['"',"'"]);function h(t,e,r){var n=parseInt(e,16)-65536;return n!=n||r?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)}function d(t){return t.replace(o,h)}function v(t){return" "===t||"\n"===t||"\t"===t||"\f"===t||"\r"===t}function w(t,e,r,o){var u,h;void 0===r&&(r={});var g=[],b=!1;function _(t){var r=e.slice(o+t).match(n);if(!r)throw new Error("Expected name, found "+e.slice(o));var a=r[0];return o+=t+a.length,d(a)}function x(t){for(;v(e.charAt(o+t));)t++;o+=t}function L(t){for(var r=0;"\\"===e.charAt(--t);)r++;return!(1&~r)}function F(){if(g.length>0&&f(g[g.length-1]))throw new Error("Did not expect successive traversals.")}for(x(0);""!==e;){var A=e.charAt(o);if(v(A))b=!0,x(1);else if(A in s)F(),g.push({type:s[A]}),b=!1,x(1);else if(","===A){if(0===g.length)throw new Error("Empty sub-selector");t.push(g),g=[],b=!1,x(1)}else if(e.startsWith("/*",o)){var O=e.indexOf("*/",o+2);if(O<0)throw new Error("Comment was not terminated");o=O+2}else if(b&&(F(),g.push({type:"descendant"}),b=!1),A in i){var j=i[A],S=j[0],C=j[1];g.push({type:"attribute",name:S,action:C,value:_(1),namespace:null,ignoreCase:!!r.xmlMode&&null})}else if("["===A){x(1);var k=null;"|"===e.charAt(o)&&(k="",o+=1),e.startsWith("*|",o)&&(k="*",o+=2);var P=_(0);null===k&&"|"===e.charAt(o)&&"="!==e.charAt(o+1)&&(k=P,P=_(1)),(null!==(u=r.lowerCaseAttributeNames)&&void 0!==u?u:!r.xmlMode)&&(P=P.toLowerCase()),x(0),C="exists";var U=a.get(e.charAt(o));if(U){if(C=U,"="!==e.charAt(o+1))throw new Error("Expected `=`");x(2)}else"="===e.charAt(o)&&(C="equals",x(1));var E="",N=null;if("exists"!==C){if(m.has(e.charAt(o))){for(var M=e.charAt(o),B=o+1;B<e.length&&(e.charAt(B)!==M||L(B));)B+=1;if(e.charAt(B)!==M)throw new Error("Attribute value didn't end");E=d(e.slice(o+1,B)),o=B+1}else{for(var T=o;o<e.length&&(!v(e.charAt(o))&&"]"!==e.charAt(o)||L(o));)o+=1;E=d(e.slice(T,o))}x(0);var G=e.charAt(o);"s"===G||"S"===G?(N=!1,x(1)):"i"!==G&&"I"!==G||(N=!0,x(1))}if(r.xmlMode||null!=N||(N=c.has(P)),"]"!==e.charAt(o))throw new Error("Attribute selector didn't terminate");o+=1;var D={type:"attribute",name:P,action:C,value:E,namespace:k,ignoreCase:N};g.push(D)}else if(":"===A){if(":"===e.charAt(o+1)){g.push({type:"pseudo-element",name:_(2).toLowerCase()});continue}var I=_(1).toLowerCase(),q=null;if("("===e.charAt(o))if(l.has(I)){if(m.has(e.charAt(o+1)))throw new Error("Pseudo-selector "+I+" cannot be quoted");if(o=w(q=[],e,r,o+1),")"!==e.charAt(o))throw new Error("Missing closing parenthesis in :"+I+" ("+e+")");o+=1}else{for(var W=o+=1,z=1;z>0&&o<e.length;o++)"("!==e.charAt(o)||L(o)?")"!==e.charAt(o)||L(o)||z--:z++;if(z)throw new Error("Parenthesis not matched");if(q=e.slice(W,o-1),p.has(I)){var R=q.charAt(0);R===q.slice(-1)&&m.has(R)&&(q=q.slice(1,-1)),q=d(q)}}g.push({type:"pseudo",name:I,data:q})}else{k=null;var $=void 0;if("*"===A)o+=1,$="*";else{if(!n.test(e.slice(o)))return g.length&&"descendant"===g[g.length-1].type&&g.pop(),y(t,g),o;"|"===e.charAt(o)&&(k="",o+=1),$=_(0)}"|"===e.charAt(o)&&(k=$,"*"===e.charAt(o+1)?($="*",o+=2):$=_(1)),"*"===$?g.push({type:"universal",namespace:k}):((null!==(h=r.lowerCaseTags)&&void 0!==h?h:!r.xmlMode)&&($=$.toLowerCase()),g.push({type:"tag",name:$,namespace:k}))}}return y(t,g),o}function y(t,e){if(t.length>0&&0===e.length)throw new Error("Empty sub-selector");t.push(e)}e.default=function(t,e){var r=[],n=w(r,""+t,e,0);if(n<t.length)throw new Error("Unmatched selector: "+t.slice(n));return r}},519:function(t,e){"use strict";var r=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0});var n={equals:"",element:"~",start:"^",end:"$",any:"*",not:"!",hyphen:"|"},o=new Set(r(r([],Object.keys(n).map((function(t){return n[t]})).filter(Boolean),!0),[":","[","]"," ","\\","(",")","'"],!1));function a(t){return t.map(s).join(", ")}function s(t){return t.map(i).join("")}function i(t){switch(t.type){case"child":return" > ";case"parent":return" < ";case"sibling":return" ~ ";case"adjacent":return" + ";case"descendant":return" ";case"universal":return u(t.namespace)+"*";case"tag":return l(t);case"pseudo-element":return"::"+c(t.name);case"pseudo":return null===t.data?":"+c(t.name):"string"==typeof t.data?":"+c(t.name)+"("+c(t.data)+")":":"+c(t.name)+"("+a(t.data)+")";case"attribute":if("id"===t.name&&"equals"===t.action&&!t.ignoreCase&&!t.namespace)return"#"+c(t.value);if("class"===t.name&&"element"===t.action&&!t.ignoreCase&&!t.namespace)return"."+c(t.value);var e=l(t);return"exists"===t.action?"["+e+"]":"["+e+n[t.action]+"='"+c(t.value)+"'"+(t.ignoreCase?"i":!1===t.ignoreCase?"s":"")+"]"}}function l(t){return""+u(t.namespace)+c(t.name)}function u(t){return null!==t?("*"===t?"*":c(t))+"|":""}function c(t){return t.split("").map((function(t){return o.has(t)?"\\"+t:t})).join("")}e.default=a},24:(t,e,r)=>{var n=r(735).default;function o(){"use strict";t.exports=o=function(){return r},t.exports.__esModule=!0,t.exports.default=t.exports;var e,r={},a=Object.prototype,s=a.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag";function p(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(e){p=function(t,e,r){return t[e]=r}}function m(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),s=new E(n||[]);return i(a,"_invoke",{value:C(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=m;var d="suspendedStart",v="suspendedYield",w="executing",y="completed",g={};function b(){}function _(){}function x(){}var L={};p(L,u,(function(){return this}));var F=Object.getPrototypeOf,A=F&&F(F(N([])));A&&A!==a&&s.call(A,u)&&(L=A);var O=x.prototype=b.prototype=Object.create(L);function j(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,l){var u=h(t[o],t,a);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==n(f)&&s.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,l)}),(function(t){r("throw",t,i,l)})):e.resolve(f).then((function(t){c.value=t,i(c)}),(function(t){return r("throw",t,i,l)}))}l(u.arg)}var o;i(this,"_invoke",{value:function(t,n){function a(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(a,a):a()}})}function C(t,r,n){var o=d;return function(a,s){if(o===w)throw Error("Generator is already running");if(o===y){if("throw"===a)throw s;return{value:e,done:!0}}for(n.method=a,n.arg=s;;){var i=n.delegate;if(i){var l=k(i,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=w;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:v,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function k(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=h(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var s=a.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function U(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(s.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return _.prototype=x,i(O,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:_,configurable:!0}),_.displayName=p(x,f,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,p(t,f,"GeneratorFunction")),t.prototype=Object.create(O),t},r.awrap=function(t){return{__await:t}},j(S.prototype),p(S.prototype,c,(function(){return this})),r.AsyncIterator=S,r.async=function(t,e,n,o,a){void 0===a&&(a=Promise);var s=new S(m(t,e,n,o),a);return r.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},j(O),p(O,f,"Generator"),p(O,u,(function(){return this})),p(O,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=N,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(U),!t)for(var r in this)"t"===r.charAt(0)&&s.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=s.call(a,"catchLoc"),u=s.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),U(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;U(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},r}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},735:t=>{function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},183:(t,e,r)=>{var n=r(24)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,r),a.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{extend:()=>gt});const t=flarum.core.compat["forum/app"];var e=r.n(t);const o=flarum.core.compat["common/extend"],a=flarum.core.compat["forum/components/NotificationGrid"];var s=r.n(a);function i(t,e,r,n,o,a,s){try{var i=t[a](s),l=i.value}catch(t){return void r(t)}i.done?e(l):Promise.resolve(l).then(n,o)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,l,"next",t)}function l(t){i(a,n,o,s,l,"throw",t)}s(void 0)}))}}var u=r(183),c=r.n(u);const f=flarum.core.compat["forum/utils/UserControls"];var p=r.n(f);const h=flarum.core.compat["common/components/Button"];var d=r.n(h);function v(){return v=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},v.apply(null,arguments)}function w(t,e){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},w(t,e)}function y(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,w(t,e)}const g=flarum.core.compat["common/components/Modal"];var b=r.n(g);const _=flarum.core.compat["common/models/User"];var x=r.n(_);const L=flarum.core.compat["common/components/Select"];var F=r.n(L);const A=flarum.core.compat["common/app"];var O=r.n(A),j=function(t){return function(e){return O().translator.trans("ianm-follow-users.lib.follow_levels."+t,e)}},S=Object.freeze([{value:"unfollow",name:j("unfollow.name"),description:j("unfollow.description")},{value:"follow",name:j("follow.name"),description:j("follow.description")},{value:"lurk",name:j("lurk.name"),description:j("lurk.description")}]),C=function(t){function r(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).state={user:null,saving:!1,followState:void 0},e.className=function(){return"iam_follow_users-selectFollowLevelModal"},e}y(r,t);var n=r.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.state.user=this.attrs.user,this.state.followState=this.state.user.followed()||"unfollow"},n.title=function(){var t;return this.trans("title",{username:m("em",null,null==(t=this.state.user)||null==t.displayName?void 0:t.displayName())})},n.content=function(){var t=this;if(!(this.state.user instanceof x()))return m("div",{class:"Modal-body"},m("p",null,this.trans("no_user_attr_provided_err"+(e().forum.attribute("debug")?"_debug":""))));var r=this.state.user,n=S.reduce((function(t,e){var r;return v({},t,((r={})[e.value]=e.name(),r))}),{}),o=S.find((function(e){return e.value===t.state.followState}));return m("div",{class:"Modal-body"},m("fieldset",null,m("legend",null,this.trans("description",{user:r})),m("div",{class:"selectFollowLevelModal-level"},m("label",{for:"selectFollowLevelModal-select"},this.trans("follow_select_label")),m(F(),{disabled:this.state.saving,id:"selectFollowLevelModal-select",onchange:this.onFollowLevelChange.bind(this),value:o.value,"aria-described-by":"selectFollowLevelModal-"+o.value+"-help",options:n}),m("p",{id:"selectFollowLevelModal-"+o.value+"-help"},o.description({user:r})))),m("fieldset",{class:"selectFollowLevelModal-actions"},m(d(),{disabled:this.state.saving,class:"Button",onclick:this.hide.bind(this)},this.trans("cancel_btn")),m(d(),{disabled:this.state.saving,class:"Button Button--primary",onclick:this.saveFollowLevel.bind(this),loading:this.state.saving},this.trans("save_btn"))))},n.onFollowLevelChange=function(){var t=this.$(".Select-input")[0];this.state.followState=t.value||"unfollow"},n.trans=function(t){for(var r,n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return(r=e().translator).trans.apply(r,["ianm-follow-users.forum.modals.select_follow_level."+t].concat(o))},n.onsubmit=function(){this.saveFollowLevel()},n.saveFollowLevel=function(){var t=l(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e="unfollow"===this.state.followState?null:this.state.followState,this.state.saving=!0,this.state.user.attribute("following")!==e){t.next=5;break}return this.hide(),t.abrupt("return");case 5:return t.next=7,this.state.user.save({followUsers:e});case 7:t.sent,this.hide();case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r}(b());const k=flarum.core.compat["forum/components/UserCard"];var P=r.n(k),U=r(362);function E(t,e,r){return N(t,(0,U.parse)(e),r)}function N(t,e,r){var n;n=Array.isArray(t)?t:[t];var o=void 0;return n.some((function(t){if("boolean"==typeof t||"number"==typeof t||"string"==typeof t||null==t)return!1;if(Array.isArray(t)){var n=N(t,e,r);return!!n&&(o=n,!0)}if(function(t,e){return e.some((function(e){return e.every((function(e){var r,n,o;switch(e.type){case"tag":return t.tag===e.name;case"attribute":if(!t.attrs)return!1;"class"===e.name&&(e.name="className");var a=t.attrs[e.name];switch("className"===e.name&&"string"==typeof a&&(a=a.trim()),e.ignoreCase&&"string"==typeof a&&(a=a.toLowerCase(),e.value=e.value.toLowerCase()),e.action){case"exists":return t.attrs.hasOwnProperty(e.name);case"equals":return a===e.value;case"start":return(null==(r=a)||null==r.startsWith?void 0:r.startsWith(e.value))||!1;case"end":return(null==(n=a)||null==n.endsWith?void 0:n.endsWith(e.value))||!1;case"element":return(null==(o=a)||null==o.split||null==(o=o.split(" "))||null==o.includes?void 0:o.includes(e.value))||!1}}return!1}))}))}(t,e))return o=t,!0;if(Array.isArray(t.children)){var a=N(t.children,e);return!!a&&(o=a,!0)}return!1})),r&&o&&r(o),o}function M(t){t instanceof x()&&e().modal.show(C,{user:t})}const B=flarum.core.compat["common/components/LinkButton"];var T=r.n(B);const G=flarum.core.compat["forum/components/UserPage"];var D=r.n(G);const I=flarum.core.compat["forum/components/Notification"];var q=r.n(I),W=function(t){function r(){return t.apply(this,arguments)||this}y(r,t);var n=r.prototype;return n.icon=function(){return"fas fa-user-friends"},n.href=function(){var t=this.attrs.notification.subject();return e().route.discussion(t)},n.content=function(){return e().translator.trans("ianm-follow-users.forum.notifications.new_discussion_text",{user:this.attrs.notification.fromUser(),title:this.attrs.notification.subject().title()})},n.excerpt=function(){return null},r}(q()),z=function(t){function r(){return t.apply(this,arguments)||this}y(r,t);var n=r.prototype;return n.icon=function(){return"fas fa-user-friends"},n.href=function(){var t=this.attrs.notification,r=t.subject(),n=t.content()||{};return e().route.discussion(r,n.postNumber)},n.content=function(){return e().translator.trans("ianm-follow-users.forum.notifications.new_post_text",{user:this.attrs.notification.fromUser()})},n.excerpt=function(){return null},r}(q()),R=function(t){function r(){return t.apply(this,arguments)||this}y(r,t);var n=r.prototype;return n.icon=function(){return"fas fa-user-plus"},n.href=function(){var t=this.attrs.notification.subject();return e().route.user(t)},n.content=function(){return e().translator.trans("ianm-follow-users.forum.notifications.new_follower_text",{user:this.attrs.notification.fromUser()})},n.excerpt=function(){return null},r}(q()),$=function(t){function r(){return t.apply(this,arguments)||this}y(r,t);var n=r.prototype;return n.icon=function(){return"fas fa-user-minus"},n.href=function(){var t=this.attrs.notification.subject();return e().route.user(t)},n.content=function(){return e().translator.trans("ianm-follow-users.forum.notifications.new_unfollower_text",{user:this.attrs.notification.fromUser()})},n.excerpt=function(){return null},r}(q());const Y=flarum.core.compat["common/models/Discussion"];var H=r.n(Y);const J=flarum.core.compat["common/components/Badge"];var K=r.n(J);const Q=flarum.core.compat["forum/components/SettingsPage"];var V=r.n(Q);const X=flarum.core.compat["common/components/Switch"];var Z=r.n(X);const tt=flarum.extensions["fof-follow-tags"],et=flarum.extensions["fof-user-directory"],rt=flarum.core.compat["forum/states/DiscussionListState"];var nt=r.n(rt),ot=tt.utils.followingPageOptions;const at=function(t){var e=ot(t);return e.users=O().translator.trans("ianm-follow-users.lib.following_link"),e},st=flarum.core.compat["common/components/Separator"];var it=r.n(st);const lt=flarum.core.compat["common/helpers/icon"];var ut=r.n(lt);const ct=flarum.core.compat["common/extenders"];var ft=r.n(ct);const pt=flarum.core.compat["common/components/Placeholder"];var mt=r.n(pt);const ht=flarum.core.compat["common/Component"];var dt=function(t){function e(){return t.apply(this,arguments)||this}return y(e,t),e.prototype.view=function(){var t=this.attrs.user;return m("div",{className:"User"},m(P(),{user:t,className:"UserCard--follow-list",controlsButtonClassName:"Button Button--icon Button--flat"}))},e}(r.n(ht)());const vt=flarum.core.compat["common/components/LoadingIndicator"];var wt=r.n(vt),yt=function(t){function r(){return t.apply(this,arguments)||this}y(r,t);var n=r.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.refresh()},n.refresh=function(){this.loading=!0,this.loadUser(e().session.user.username()),this.followedUsers=e().session.user.followedUsers(),this.loading=!1,m.redraw()},n.changeUserFollowOptions=function(t){e().modal.show(C,{user:t})},n.content=function(){return this.loading?m("div",{className:"DiscussionList"},m(wt(),null)):0===this.followedUsers.length?m("div",{className:"DiscussionList"},m(mt(),{text:e().translator.trans("ianm-follow-users.forum.profile_page.no_following")})):m("div",{className:"FollowedUserList"},m("ul",{className:"FollowedUserList-users"},this.followedUsers.map((function(t){return m("li",{key:t.id(),"data-id":t.id()},m(dt,{user:t}))}))))},n.show=function(){this.user=e().session.user,m.redraw()},r}(D());const gt=[new(ft().Model)(x()).attribute("followed").hasMany("followedUsers").hasMany("followedBy").attribute("blocksFollow").attribute("canBeFollowed").attribute("followingCount").attribute("followerCount"),(new(ft().Routes)).add("user.followedUsers","/u/:username/followedUsers",yt)];e().initializers.add("ianm-follow-users",(function(){(0,o.extend)(p(),"userControls",(function(t,r){var n=!r.canBeFollowed()&&r.followed(),o="fas fa-user-friends";n&&t.add("unfollow",m(d(),{icon:o,onclick:l(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.save({followUsers:null});case 2:t.sent,m.redraw();case 4:case"end":return t.stop()}}),t)})))},e().translator.trans("ianm-follow-users.forum.user_controls.unfollow_button"))),e().session.user&&e().session.user!==r&&r.canBeFollowed()&&!n&&(!e().forum.attribute("ianm-follow-users.button-on-profile")||"fof_user_directory"===e().current.data.routeName&&e().forum.attribute("userDirectorySmallCards"))&&t.add("follow",m(d(),{icon:o,onclick:M.bind(this,r)},e().translator.trans("ianm-follow-users.forum.user_controls."+(r.followed()?"change_button":"follow_button"))))})),(0,o.extend)(P().prototype,"view",(function(t){var r=this.attrs.user;if(e().forum.attribute("ianm-follow-users.button-on-profile")&&e().session.user&&e().session.user!==r&&r.canBeFollowed()&&!t.attrs.className.includes("UserCard--small")){var n=m(d(),{className:"Button Button--follow-profile",icon:"fas fa-user-friends",onclick:M.bind(this,r)},r.followed()?e().translator.trans("ianm-follow-users.forum.badge.label."+r.followed()):e().translator.trans("ianm-follow-users.forum.user_controls.follow_button"));E(t,".UserCard-profile",(function(t){t.children.splice(2,0,n)}))}})),(0,o.extend)(D().prototype,"navItems",(function(t){if(e().session.user&&e().session.user===this.user){var r=this.user.followingCount();t.add("followed-users",m(T(),{href:e().route("user.followedUsers",{username:this.user.slug()}),icon:"fas fa-user-friends"},e().translator.trans("ianm-follow-users.forum.profile_link"),m("span",{className:"Button-badge"},r)))}})),(0,o.extend)(H().prototype,"badges",(function(t){var r;null!=(r=this.user())&&null!=r.followed&&r.followed()&&t.add("user-following",m(K(),{label:e().translator.trans("ianm-follow-users.forum.badge.label."+this.user().followed()),icon:"fas fa-user-friends",type:"friend"}))})),(0,o.extend)(x().prototype,"badges",(function(t){this.followed()&&t.add("user-following",m(K(),{label:e().translator.trans("ianm-follow-users.forum.badge.label."+this.followed()),icon:"fas fa-user-friends",type:"friend"}))})),(0,o.extend)(V().prototype,"privacyItems",(function(t){var r=this;t.add("follow-users-block",m(Z(),{state:this.user.preferences().blocksFollow,onchange:function(t){r.blocksFollowLoading=!0,r.user.savePreferences({blocksFollow:t}).then((function(){r.blocksFollowLoading=!1,m.redraw()}))},loading:this.blocksFollowLoading},e().translator.trans("ianm-follow-users.forum.settings.block_follow")))})),e().initializers.has("fof/follow-tags")&&(tt.utils.followingPageOptions=at,tt.utils.followingPageOptions("forum.index.following"),(0,o.extend)(nt().prototype,"requestParams",(function(t){if(tt.utils.isFollowingPage()&&e().session.user){this.followTags||(this.followTags=tt.utils.getDefaultFollowingFiltering());var r=this.followTags;"following"===e().current.get("routeName")&&"users"===r&&(t.filter["following-users"]=!0,delete t.filter.subscription)}}))),e().initializers.has("fof-user-directory")&&(0,o.extend)(et.UserDirectoryPage.prototype,"groupItems",(function(t){var r=this;t.add("follow-users",et.CheckableButton.component({className:"GroupFilterButton",icon:"fas fa-user-friends",checked:"is:followeduser"===this.enabledSpecialGroupFilters["ianm-follow-users"],onclick:function(){var t="ianm-follow-users";"is:followeduser"===r.enabledSpecialGroupFilters[t]?r.enabledSpecialGroupFilters[t]="":r.enabledSpecialGroupFilters[t]="is:followeduser",r.changeParams(r.params().sort)}},e().translator.trans("ianm-follow-users.forum.filter.following")),65),t.add("separator",m(it(),null),50)})),(0,o.extend)(P().prototype,"infoItems",(function(t){if(this.attrs.user&&e().forum.attribute("ianm-follow-users.stats-on-profile")){var r=this.attrs.user,n=r.followingCount(),o=r.followerCount();t.add("followers",m("div",{className:"FollowUsers--stats"},m("span",null,ut()("fas fa-user-friends"),m("span",{className:"FollowUsers--count"},n," ")," ",e().translator.trans("ianm-follow-users.forum.followed",{count:n}),m("span",{className:"FollowUsers--count"},o)," ",e().translator.trans("ianm-follow-users.forum.followers",{count:o}))),40)}})),e().notificationComponents.newFollower=R,e().notificationComponents.newUnfollower=$,e().notificationComponents.newDiscussionByUser=W,e().notificationComponents.newPostByUser=z,(0,o.extend)(s().prototype,"notificationTypes",(function(t){t.add("newFollower",{name:"newFollower",icon:"fas fa-user-plus",label:e().translator.trans("ianm-follow-users.forum.settings.notify_new_follower_label")}),t.add("newUnfollower",{name:"newUnfollower",icon:"fas fa-user-minus",label:e().translator.trans("ianm-follow-users.forum.settings.notify_new_unfollower_label")}),t.add("newDiscussionByUser",{name:"newDiscussionByUser",icon:"fas fa-user-friends",label:e().translator.trans("ianm-follow-users.forum.settings.notify_new_discussion_label")}),t.add("newPostByUser",{name:"newPostByUser",icon:"fas fa-user-friends",label:e().translator.trans("ianm-follow-users.forum.settings.notify_new_post_label")})}))}),-1)})(),module.exports=n})();
//# sourceMappingURL=forum.js.map